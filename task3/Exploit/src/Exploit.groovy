final workingDir = new File('.').getCanonicalPath()

(0x0000 .. 0xffff).each {
    final time = it * 0x10000
    
    try {
        final proc = "./challenge".execute(["REAL_TIME=${Integer.toHexString(time)}", "LD_PRELOAD=$workingDir/hook.so"], null)

        stdout = proc.in.text
        if (!(stdout =~ /^'arlogh Qoylu'pu'?/)) {
            print "time: ${Integer.toHexString(time)}: $stdout"
        }
    } catch (Exception e) {
        println "time: $time"
        e.printStackTrace()
    }
}